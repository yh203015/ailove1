<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’— ç²‰è‰²æƒŠå–œ Â· æ°”æ³¡æ°¸ä¹…åœç•™ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(145deg, #ffc0cb, #ffb6c1, #ff9eb5, #fba0a0);
            font-family: 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* ä¸»æƒŠå–œæŒ‰é’® - å±…ä¸­ */
        .main-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff4d6d, #ff8e6e);
            color: white;
            border: none;
            padding: 18px 38px;
            border-radius: 60px;
            font-size: 1.6rem;
            font-weight: bold;
            letter-spacing: 2px;
            box-shadow: 0 10px 25px rgba(255, 77, 109, 0.5);
            cursor: pointer;
            transition: transform 0.2s;
            white-space: nowrap;
            z-index: 100;
        }
        .main-btn:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        /* éŸ³ä¹å¼€å…³æŒ‰é’® - å›ºå®šåœ¨å³ä¸‹è§’ */
        .music-toggle {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #a4508b, #5f0a87);
            color: white;
            border: none;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            font-size: 2.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(164, 80, 139, 0.5);
            cursor: pointer;
            transition: 0.2s;
            z-index: 200;
        }
        .music-toggle.playing {
            background: linear-gradient(135deg, #3a9e5a, #6dd5a8);
        }
        .music-toggle:active {
            transform: scale(0.95);
        }

        /* çƒŸèŠ±ä¸Šå‡è½¨è¿¹ */
        .trail {
            position: absolute;
            width: 3px;
            height: 0;
            background: linear-gradient(to top, #fff, #ffdd99, transparent);
            border-radius: 2px;
            transform-origin: bottom center;
            animation: rise 1s ease-out forwards;
        }
        @keyframes rise {
            to { height: 70vh; opacity: 0; }
        }

        /* çƒŸèŠ±çˆ†ç‚¸ç²’å­ */
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            opacity: 0;
            filter: blur(1px);
            animation: pop 1.2s ease-out forwards;
        }
        @keyframes pop {
            0% { opacity: 1; transform: scale(1) translate(0, 0); }
            100% { opacity: 0; transform: scale(0.5) translate(var(--tx), var(--ty)); }
        }

        /* æ°”æ³¡æƒ…è¯ - æ°¸ä¹…åœç•™ï¼Œä¸æ¶ˆå¤± */
        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(4px);
            padding: 16px 32px;
            border-radius: 50px 50px 50px 10px;
            font-size: 1.4rem;
            color: #b34180;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2), 0 0 0 3px #ffb6c1;
            border: 1px solid #fff0f5;
            white-space: nowrap;
            opacity: 0;
            animation: floatIn 1.5s ease-out forwards;
            pointer-events: none;
            z-index: 150;
            max-width: 80vw;
            overflow: visible;
            line-height: 1.4;
            /* åœç•™åä¿æŒä½ç½® */
        }
        @keyframes floatIn {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(1);
            }
        }

        /* æç¤ºæ–‡å­— */
        .hint {
            position: fixed;
            bottom: 120px;
            right: 40px;
            color: #8b3f5e;
            font-size: 0.9rem;
            background: rgba(255,255,255,0.4);
            padding: 4px 12px;
            border-radius: 20px;
            z-index: 180;
        }
    </style>
</head>
<body>
    <!-- ä¸»æƒŠå–œæŒ‰é’® -->
    <button class="main-btn" id="surpriseBtn">ğŸ’Œ ç‚¹æˆ‘ï¼Œæœ‰æƒŠå–œ</button>

    <!-- éŸ³ä¹å¼€å…³æŒ‰é’®ï¼ˆå³ä¸‹è§’ï¼‰ -->
    <button class="music-toggle" id="musicToggleBtn">ğŸ”‡</button>

    <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆä½¿ç”¨å¯é é“¾æ¥ï¼‰ -->
    <audio id="bgMusic" loop preload="auto">
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <!-- çˆ†ç‚¸éŸ³æ•ˆ -->
    <audio id="boomSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-firework-explosion-2759.mp3" type="audio/mpeg">
    </audio>

    <script>
        (function() {
            const surpriseBtn = document.getElementById('surpriseBtn');
            const musicToggle = document.getElementById('musicToggleBtn');
            const bgMusic = document.getElementById('bgMusic');
            const boomSound = document.getElementById('boomSound');

            let isMusicPlaying = false;
            let isSurpriseActive = false;

            const colors = ['#FF4D6D', '#FF8E6E', '#A4508B', '#5F0A87', '#FF69B4', '#FF1493', '#DB7093', '#C71585'];
            const messages = [
                "ğŸ’– å…¶å®æˆ‘å–œæ¬¢ä½ å¾ˆä¹…äº†ã€‚",
                "âœ¨ ä¸æ˜¯ä¸€æ—¶å…´èµ·ï¼Œæ˜¯è®¤çœŸçš„å–œæ¬¢ã€‚",
                "ğŸŒ™ å–œæ¬¢å’Œä½ å¾…åœ¨ä¸€èµ·çš„æ¯ä¸€ç§’ã€‚",
                "ğŸµ ä½ å°±åƒä¸€é¦–å¬ä¸è…»çš„æ­Œã€‚",
                "ğŸŒˆ æœ‰ä½ åœ¨ï¼Œæ¯å¤©éƒ½æ˜¯æ™´å¤©ã€‚",
                "ğŸ€ é‡è§ä½ æ˜¯æœ€å¹¸è¿çš„äº‹ã€‚",
                "ğŸŒº æƒ³å’Œä½ ä¸€èµ·çœ‹éå››å­£ã€‚",
                "ğŸ’« ä½ æ˜¯æˆ‘å¿ƒé‡Œæœ€äº®çš„å…‰ã€‚"
            ];

            // ç²¾å¿ƒè®¾è®¡çš„8ä¸ªç»ˆç‚¹åç§»é‡ï¼Œä¿è¯ä»»æ„ä¸¤ä¸ªæ°”æ³¡é‡å éƒ¨åˆ†ä¸è¶…è¿‡1/4
            // æ¯ä¸ªåç§»é‡ (tx, ty) æ˜¯ç›¸å¯¹äºå±å¹•ä¸­å¿ƒ(-50%å¤„)çš„åƒç´ åç§»
            // ç»è¿‡è®¡ç®—ï¼Œè¿™äº›ä½ç½®ä¹‹é—´çš„è·ç¦»è¶³å¤Ÿè¿œï¼Œå³ä½¿æœ‰é‡å ä¹Ÿå¾ˆå°
            const positions = [
                { tx: -300, ty: -220 }, // å·¦ä¸Š
                { tx: 300, ty: -220 },  // å³ä¸Š
                { tx: -220, ty: 200 },  // å·¦ä¸‹
                { tx: 220, ty: 200 },   // å³ä¸‹
                { tx: 0, ty: -280 },    // ä¸Š
                { tx: 0, ty: 260 },     // ä¸‹
                { tx: -260, ty: -20 },  // å·¦ä¸­åä¸Š
                { tx: 260, ty: 40 }     // å³ä¸­åä¸‹
            ];

            // è½»å¾®éšæœºåç§»ï¼Œè®©ä½ç½®æ›´è‡ªç„¶ï¼Œä½†ä¿æŒé—´è·
            function getFinalPosition(basePos) {
                const randomOffsetX = (Math.random() - 0.5) * 30;
                const randomOffsetY = (Math.random() - 0.5) * 30;
                return {
                    tx: basePos.tx + randomOffsetX,
                    ty: basePos.ty + randomOffsetY
                };
            }

            // éŸ³ä¹å¼€å…³
            musicToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                if (isMusicPlaying) {
                    bgMusic.pause();
                    isMusicPlaying = false;
                    musicToggle.textContent = 'ğŸ”‡';
                    musicToggle.classList.remove('playing');
                } else {
                    bgMusic.play()
                        .then(() => {
                            isMusicPlaying = true;
                            musicToggle.textContent = 'ğŸ”Š';
                            musicToggle.classList.add('playing');
                        })
                        .catch(err => {
                            console.warn('æ’­æ”¾å¤±è´¥:', err);
                            alert('æ— æ³•æ’­æ”¾éŸ³ä¹ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®æˆ–ç½‘ç»œ');
                        });
                }
            });

            // ä¸»æƒŠå–œæŒ‰é’®
            surpriseBtn.addEventListener('click', function() {
                if (isSurpriseActive) return;
                isSurpriseActive = true;

                surpriseBtn.style.display = 'none';

                // ç”Ÿæˆ8æ¡æ°¸ä¹…åœç•™çš„æ°”æ³¡
                createBubbles();

                // çƒŸèŠ±å¼€åœº
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => launchFirework(), i * 400);
                }
                setInterval(() => {
                    launchFirework();
                }, 2200);
            });

            function launchFirework() {
                const startX = Math.random() > 0.5 ? 30 : window.innerWidth - 30;
                const startY = window.innerHeight - 40;
                const explodeX = startX + (Math.random() - 0.5) * 600;
                const explodeY = window.innerHeight * 0.2 + Math.random() * 200;

                const trail = document.createElement('div');
                trail.classList.add('trail');
                trail.style.left = startX + 'px';
                trail.style.bottom = '30px';
                document.body.appendChild(trail);

                setTimeout(() => {
                    trail.remove();
                    explode(explodeX, explodeY);

                    const boomClone = boomSound.cloneNode(true);
                    boomClone.volume = 0.5;
                    boomClone.play().catch(e => console.log('çˆ†ç‚¸éŸ³æ•ˆæ’­æ”¾å¤±è´¥', e));
                    setTimeout(() => boomClone.remove(), 3000);
                }, 1000);
            }

            function explode(centerX, centerY) {
                for (let i = 0; i < 130; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const velocity = 100 + Math.random() * 250;
                    const tx = Math.cos(angle) * velocity * (0.6 + Math.random() * 0.6);
                    const ty = Math.sin(angle) * velocity * (0.6 + Math.random() * 0.6);

                    const particle = document.createElement('div');
                    particle.classList.add('particle');
                    particle.style.left = centerX + 'px';
                    particle.style.top = centerY + 'px';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.setProperty('--tx', tx + 'px');
                    particle.style.setProperty('--ty', ty + 'px');
                    particle.style.width = (4 + Math.random() * 6) + 'px';
                    particle.style.height = particle.style.width;
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), 1200);
                }
            }

            function createBubbles() {
                messages.forEach((msg, index) => {
                    // æ¯ä¸ªæ°”æ³¡ä½¿ç”¨ä¸åŒçš„åŸºç¡€ä½ç½®ï¼Œå¹¶åŠ ä¸Šéšæœºå°åç§»
                    const basePos = positions[index % positions.length];
                    const finalPos = getFinalPosition(basePos);

                    const bubble = document.createElement('div');
                    bubble.classList.add('bubble');
                    bubble.textContent = msg;
                    bubble.style.left = '50%';
                    bubble.style.top = '50%';
                    bubble.style.setProperty('--tx', finalPos.tx + 'px');
                    bubble.style.setProperty('--ty', finalPos.ty + 'px');
                    bubble.style.animationDelay = (index * 0.2) + 's'; // ä¾æ¬¡å‡ºç°

                    document.body.appendChild(bubble);
                    // ä¸å†ç§»é™¤æ°”æ³¡ï¼Œæ°¸ä¹…ä¿ç•™
                });
            }
        })();
    </script>
</body>
</html>